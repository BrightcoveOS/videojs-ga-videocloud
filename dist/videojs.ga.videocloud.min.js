/*
* videojs-ga - v0.4.2 - 2016-11-22
* Copyright (c) 2016 Michael Bensoussan
* Licensed MIT
*/
(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};videojs.plugin("ga",function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;return null==b&&(b={}),C=document.createElement("a"),C.href=document.referrer,self!==top&&"preview-players.brightcove.net"===window.location.host&&(C.hostname="studio.brightcove.com")?void videojs.log("Google analytics plugin will not track events in Video Cloud Studio"):(B=this,e={},this.options()["data-setup"]&&(w=JSON.parse(this.options()["data-setup"]),w.ga&&(e=w.ga)),g=["player_load","video_load","percent_played","start","end","seek","play","pause","resize","volume_change","error","fullscreen"],n=b.eventsToTrack||e.eventsToTrack||g,z=b.percentsPlayedInterval||e.percentsPlayedInterval||10,k=b.eventCategory||e.eventCategory||"Brightcove Player",f=b.eventLabel||e.eventLabel,I=b.sendbeaconOverride||!1,y=[],K=!1,i=!1,F=E=0,G=!1,l="",d="",m={video_load:"Video Load",percent_played:"Percent played",start:"Media Begin",seek_start:"Seek start",seek_end:"Seek end",play:"Media Play",pause:"Media Pause",error:"Error",fullscreen_exit:"Fullscreen Exited",fullscreen_enter:"Fullscreen Entered",resize:"Resize",volume_change:"Volume Change",player_load:"Player Load",end:"Media Complete"},q=function(a){return b.eventNames&&b.eventNames[a]?b.eventNames[a]:e.eventNames&&e.eventNames[a]?e.eventNames[a]:m[a]?m[a]:a},p=function(a){var b;return window.ga&&"create"!==a?(b=r(),b?b+"."+a:a):a},r=function(){var a;return b.trackerName?b.trackerName:e.trackerName?e.trackerName:window.ga&&window.ga.getAll&&(a=ga.getAll(),a.length>0)?a[0].get("name"):null},("players.brightcove.net"===window.location.host||"preview-players.brightcove.net"===window.location.host)&&(M=b.tracker||e.tracker,M&&(!function(a,b,c,d,e,f,g){return a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){return(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create",M,"auto"),ga("require","displayfeatures"))),c=/(\s|^)vjs-ad-(playing|loading)(\s|$)/,u=function(a){return c.test(a.el().className)},v=function(){u(B)||(l=f?f:B.mediainfo&&B.mediainfo.id?B.mediainfo.id+" | "+B.mediainfo.name:this.currentSrc().split("/").slice(-1)[0].replace(/\.(\w{3,4})(\?.*)?$/i,""),B.mediainfo&&B.mediainfo.id&&B.mediainfo.id!==d&&(d=B.mediainfo.id,y=[],K=!1,i=!1,F=E=0,G=!1,a.call(n,"video_load")>=0&&H(q("video_load"),!0)))},L=function(){var b,c,d,e,f;if(!u(B)){for(b=Math.round(this.currentTime()),c=Math.round(this.duration()),e=Math.round(b/c*100),d=f=0;99>=f;d=f+=z)e>=d&&a.call(y,d)<0&&(a.call(n,"percent_played")>=0&&0!==e&&H(q("percent_played"),!0,d),e>0&&y.push(d));a.call(n,"seek")>=0&&(F=E,E=b,Math.abs(F-E)>1&&(G=!0,H(q("seek_start"),!1,F),H(q("seek_end"),!1,E)))}},h=function(){u(B)||i||(H(q("end"),!0),i=!0)},A=function(){var a;u(B)||(a=Math.round(this.currentTime()),H(q("play"),!0,a),G=!1)},J=function(){return!u(B)&&a.call(n,"start")>=0&&!K?(H(q("start"),!0),K=!0):void 0},x=function(){var a,b;u(B)||(a=Math.round(this.currentTime()),b=Math.round(this.duration()),a===b||G||H(q("pause"),!0,a))},N=function(){var a;a=this.muted()===!0?0:this.volume(),H(q("volume_change"),!1,a)},D=function(){H(q("resize")+" - "+this.width()+"*"+this.height(),!0)},j=function(){var a;a=Math.round(this.currentTime()),H(q("error"),!0,a)},o=function(){var a;a=Math.round(this.currentTime()),("function"==typeof this.isFullscreen?this.isFullscreen():void 0)||("function"==typeof this.isFullScreen?this.isFullScreen():void 0)?H(q("fullscreen_enter"),!1,a):H(q("fullscreen_exit"),!1,a)},H=function(a,b,c){I?I(k,a,l,c,b):window.ga?ga(p("send"),"event",{eventCategory:k,eventAction:a,eventLabel:l,eventValue:c,nonInteraction:b}):window._gaq?_gaq.push(["_trackEvent",k,a,l,c,b]):videojs.log("Google Analytics not detected")},a.call(n,"player_load")>=0&&(self!==top?(s=document.referrer,t=1):(s=window.location.href,t=0)),I?I(k,q("player_load"),s,t,!0):window.ga?ga(p("send"),"event",{eventCategory:k,eventAction:q("player_load"),eventLabel:s,eventValue:t,nonInteraction:!0}):window._gaq?_gaq.push(["_trackEvent",k,q("player_load"),s,t,!1]):videojs.log("Google Analytics not detected"),void this.ready(function(){return this.on("loadedmetadata",v),this.on("timeupdate",L),a.call(n,"end")>=0&&this.on("ended",h),a.call(n,"play")>=0&&this.on("play",A),a.call(n,"start")>=0&&this.on("playing",J),a.call(n,"pause")>=0&&this.on("pause",x),a.call(n,"volume_change")>=0&&this.on("volumechange",N),a.call(n,"resize")>=0&&this.on("resize",D),a.call(n,"error")>=0&&this.on("error",j),a.call(n,"fullscreen")>=0?this.on("fullscreenchange",o):void 0}))})}).call(this);